<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SAS ‚Ä¢ CNH Social</title>
    <link rel="icon" href="https://statics.recife.pe.gov.br/images/automacao/cnh-social/icon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
      :root {
        --brand-primary: #0053a4;
        --brand-secondary: #003a73;
        --brand-highlight: #00a3ff;
        --surface: #ffedd4;
        --surface-strong: #ffffff;
        --border-color: #d0d7e2;
        --text-strong: #1b263b;
        --text-muted: #5b6c8c;
      }

      *, *::before, *::after {
        box-sizing: border-box;
      }

      .visually-hidden {
        position: absolute !important;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: "Public Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        color: var(--text-strong);
        min-height: 100vh;
      }

      header.site-header {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0;
        height: 385px;
        min-height: 385px;
        overflow: hidden;
        width: 100%;
      }

      header.site-header picture {
        display: block;
        width: 100%;
        height: 100%;
      }

      header.site-header .hero-image {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
      }

      header .lead {
        color: rgba(255, 255, 255, 0.82);
        max-width: 100%;
        font-size: 1rem;
        line-height: 1.65;
        text-align: justify;
      }

      .badge-open {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        font-weight: 600;
        padding: 0.45rem 0.9rem;
        border-radius: 999px;
        background-color: rgba(255, 255, 255, 0.14);
      }

      .user-greeting {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.05rem;
        font-weight: 600;
        margin-bottom: 2rem;
        padding: 1rem 1.5rem;
        border-radius: 1rem;
        background: linear-gradient(135deg, rgba(0, 83, 164, 0.09), rgba(0, 163, 255, 0.12));
        color: var(--text-strong);
        box-shadow: 0 10px 30px rgba(0, 45, 98, 0.08);
      }

      .user-greeting::before {
        content: "üëã";
        font-size: 1.4rem;
      }

      .minhas-inscricoes-grid {
        margin-top: 1rem;
      }

      .minhas-inscricao-card {
        cursor: pointer;
        transition: transform 0.18s ease, box-shadow 0.18s ease;
        border: 1px solid rgba(0, 83, 164, 0.12);
        border-radius: 4px;
      }

      .minhas-inscricao-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 30px rgba(0, 45, 98, 0.12);
      }

      .minhas-inscricao-card.is-loading {
        pointer-events: none;
        opacity: 0.7;
      }

      .minhas-inscricoes-placeholder {
        padding: 1.25rem;
        border-radius: 4px;
        background: rgba(0, 83, 164, 0.05);
        border: 1px dashed rgba(0, 83, 164, 0.2);
        color: var(--text-muted);
      }

      .resumo-inscricao-list dt {
        font-size: 0.75rem;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: var(--text-muted);
      }

      .resumo-inscricao-list dd {
        font-weight: 600;
        color: var(--text-strong);
      }

      .resumo-inscricao-pre {
        white-space: pre-wrap;
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
        font-size: 0.95rem;
        background: rgba(0, 83, 164, 0.08);
        color: var(--brand-secondary);
        padding: 1rem;
        border-radius: 0.75rem;
      }

      .publicacoes-panel,
      .updates-panel {
        border-radius: 4px;
      }

      .download-card strong {
        font-size: 1rem;
        color: var(--text-strong);
      }

      .download-card p {
        margin: 0;
        color: var(--text-muted);
        font-size: 0.95rem;
        line-height: 1.4;
      }

      .download-card a {
        font-weight: 600;
      }

      .btn-submit.is-disabled {
        cursor: not-allowed;
        opacity: 0.65;
        box-shadow: none;
      }

      .btn-submit.is-disabled:focus-visible {
        box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.35);
      }

      input[type="text"],
      textarea {
        text-transform: uppercase;
      }

      input[type="email"] {
        text-transform: lowercase;
      }

      .modal-backdrop {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 1.5rem;
        background-color: rgba(17, 24, 39, 0.6);
        z-index: 2000;
      }

      .modal-backdrop.is-open {
        display: flex;
      }

      .modal-card {
        width: min(32rem, 100%);
        max-height: 90vh;
        overflow-y: auto;
        background: var(--surface-strong);
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 24px 48px rgba(15, 23, 42, 0.28);
        outline: none;
        position: relative;
      }

      .modal-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 1rem;
      }

      .title--alerta {
        color: #c53030;
      }

      .title--sucesso {
        color: #1b873f;
      }

      .modal-message {
        margin-bottom: 1rem;
        color: var(--text-strong);
      }

      .modal-list {
        padding-left: 1.25rem;
        margin: 0;
        color: var(--text-strong);
        list-style: disc;
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.75rem;
        margin-top: 1.5rem;
      }

      .modal-close-button {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        background: none;
        border: none;
        color: var(--text-muted);
        font-size: 1.5rem;
        cursor: pointer;
        line-height: 1;
      }

      .modal-close-button:focus-visible {
        outline: 2px solid var(--brand-highlight);
        outline-offset: 2px;
      }

      .error-text {
        display: block;
        margin-top: 0.35rem;
        font-size: 0.85rem;
        color: #c53030;
      }

      .is-invalid {
        border-color: #c53030 !important;
      }

      .form-check-input.is-invalid {
        border-color: #c53030;
        box-shadow: none;
      }

      .form-check .error-text {
        margin-left: 1.75rem;
      }

      #publicacoes-list li + li {
        margin-top: 0.75rem;
      }

      .publicacoes-item {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .publicacoes-item-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
      }

      .publicacoes-item-icon {
        display: inline-block;
        width: 1.5rem;
        height: 1.5rem;
        flex-shrink: 0;
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
      }

      .publicacoes-item-icon--pdf {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23d32f2f' d='M6 2h7l5 5v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z'/%3E%3Cpath fill='%23ef5350' d='M13 2v5h5'/%3E%3Ctext x='12' y='17' text-anchor='middle' font-family='Arial, sans-serif' font-size='7' font-weight='700' fill='%23fff'%3EPDF%3C/text%3E%3C/svg%3E");
      }

      .publicacoes-item-icon--image {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Crect x='3' y='4' width='18' height='16' rx='2' fill='%23215695'/%3E%3Crect x='4.5' y='5.5' width='15' height='13' rx='1.2' fill='%233968c8'/%3E%3Ccircle cx='9' cy='11' r='2.2' fill='%23fff59d'/%3E%3Cpath fill='%23c5cae9' d='M6 18l4.2-4.6 2.7 3.2 2.6-3L18 18z'/%3E%3C/svg%3E");
      }

      .publicacoes-item-icon--generic {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%233f51b5' d='M7 2h7l5 5v15a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z'/%3E%3Cpath fill='%235c6bc0' d='M14 2v5h5'/%3E%3Crect x='8.5' y='12' width='7' height='1.5' rx='.75' fill='%23c5cae9'/%3E%3Crect x='8.5' y='15' width='5' height='1.5' rx='.75' fill='%23c5cae9'/%3E%3C/svg%3E");
      }

      .publicacoes-item time {
        flex-shrink: 0;
      }

      @media (min-width: 576px) {
        .publicacoes-item {
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
        }
      }

      @media (max-width: 575.98px) {
        .publicacoes-item-link {
          align-items: flex-start;
        }
      }

      .updates-panel {
        border-left: 3px solid var(--brand-highlight);
        padding-left: 1.2rem;
        color: var(--text-muted);
      }

      .updates-panel time {
        font-size: 0.85rem;
        color: var(--brand-secondary);
        font-weight: 600;
        letter-spacing: 0.05em;
        text-transform: uppercase;
      }

      footer {
        color: var(--text-muted);
        padding: 2.5rem 0 2rem;
        font-size: 0.9rem;
      }

      main {
        padding: 0.75rem 0 4rem;
      }

      .form-wrapper {
        background: transparent;
        border-radius: 1.5rem;
        padding: clamp(1.5rem, 2vw + 1rem, 3rem);
        box-shadow: none;
      }

      .form-wrapper form {
        margin: 0;
      }

      .section-nav {
        position: relative;
        z-index: 1;
        padding: 0;
        margin-bottom: clamp(1.5rem, 1.25rem + 1vw, 2.25rem);
      }

      .section-nav__inner {
        border-radius: 1.5rem;
        padding: clamp(0.5rem, 0.25rem + 1vw, 1.25rem);
        display: flex;
        flex-direction: column;
        gap: clamp(0.5rem, 0.25rem + 0.75vw, 1.5rem);
      }

      .section-nav__top {
        display: flex;
        align-items: center;
        gap: clamp(0.75rem, 0.5rem + 1vw, 2rem);
        justify-content: space-between;
        flex-wrap: wrap;
      }

      .section-nav__eyebrow {
        font-size: 0.95rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-weight: 600;
        color: var(--brand-secondary);
      }

      .section-nav__registration {
        margin-left: auto;
        padding: 0.65rem 1rem;
        border-radius: 0.85rem;
        background: rgba(0, 83, 164, 0.06);
        border: 1px solid rgba(0, 83, 164, 0.2);
        min-width: clamp(12rem, 11rem + 4vw, 16rem);
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
      }

      .section-nav__registration-label {
        font-size: 0.72rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--text-muted);
        font-weight: 600;
      }

      .section-nav__registration-value {
        font-size: 1rem;
        font-weight: 700;
        color: var(--brand-secondary);
        letter-spacing: 0.02em;
      }

      .section-nav__list {
        --step-size: 2.75rem;
        --step-progress: 0;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: clamp(0.5rem, 0.5rem + 1vw, 1.75rem);
        list-style: none;
        padding: 0 clamp(0.5rem, 0.25rem + 1vw, 1.5rem) 0;
        margin: 0;
        position: relative;
      }

      .section-nav__list::before,
      .section-nav__list::after {
        content: "";
        position: absolute;
        top: calc(var(--step-size) / 2);
        left: calc(var(--step-size) / 2);
        height: 4px;
        width: calc(100% - var(--step-size));
        border-radius: 999px;
        transform: translateY(-50%);
      }

      .section-nav__list::before {
        background: #e2e6ef;
        z-index: 0;
      }

      .section-nav__list::after {
        background: linear-gradient(90deg, #2ecc71 0%, #2ecc71 55%, #0d6efd 100%);
        transform-origin: left center;
        transform: scaleX(var(--step-progress));
        transition: transform 0.35s ease;
        z-index: 1;
      }

      .section-nav__item {
        position: relative;
        flex: 1;
        min-width: 6rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        z-index: 2;
      }

      .section-nav__link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: var(--step-size);
        height: var(--step-size);
        border-radius: 50%;
        border: 3px solid #cfd5e4;
        background: #ffffff;
        color: #7b8ba6;
        font-weight: 700;
        font-size: 1rem;
        box-shadow: 0 6px 14px rgba(15, 23, 42, 0.12);
        transition: border-color 0.25s ease, color 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
        cursor: pointer;
        position: relative;
      }

      .section-nav__icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        font-size: 1.2rem;
      }

      .section-nav__icon i {
        line-height: 1;
      }

      .section-nav__link:hover,
      .section-nav__link:focus-visible {
        border-color: var(--brand-highlight);
        color: var(--brand-highlight);
        outline: none;
      }

      .section-nav__link.is-active {
        border-color: #0d6efd;
        color: #0d6efd;
        box-shadow: 0 8px 20px rgba(13, 110, 253, 0.25);
      }

      .section-nav__link.is-complete {
        background: linear-gradient(135deg, #2ecc71, #1fab63);
        border-color: transparent;
        color: #ffffff;
      }

      .section-nav__link.is-complete .section-nav__icon {
        opacity: 0;
      }

      .section-nav__link.is-complete::after {
        content: "¬π3";
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
      }

      .section-nav__label {
        font-size: 0.9rem;
        text-align: center;
        color: var(--brand-secondary);
        font-weight: 600;
        line-height: 1.3;
        max-width: 8.5rem;
      }

      .section-nav__item.is-complete .section-nav__label {
        color: #1fab63;
      }

      .section-nav__item.is-active .section-nav__label {
        color: #0d6efd;
      }

      .step-actions {
        margin-top: clamp(1.5rem, 1.1rem + 1vw, 2.5rem);
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        align-items: center;
      }

      .step-actions__button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.75rem 1.6rem;
        border-radius: 999px;
        border: 1px solid transparent;
        font-weight: 600;
        font-size: 1rem;
        line-height: 1;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.96), rgba(255, 246, 230, 0.9));
        color: var(--brand-secondary);
        box-shadow: 0 8px 20px rgba(15, 23, 42, 0.12);
        transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease, background 0.2s ease;
      }

      .step-actions__button--next {
        margin-left: auto;
      }

      .step-actions__button:hover,
      .step-actions__button:focus-visible {
        transform: translateY(-1px);
        box-shadow: 0 12px 26px rgba(15, 23, 42, 0.18);
        outline: none;
      }

      .step-actions__button:focus-visible {
        filter: brightness(1.03);
      }

      .step-actions__button--next {
        background: linear-gradient(135deg, var(--brand-primary), var(--brand-highlight));
        color: #ffffff;
      }

      .step-actions__button--next:hover,
      .step-actions__button--next:focus-visible {
        filter: saturate(1.05);
      }

      .step-actions__button--prev {
        border: 1px solid rgba(0, 83, 164, 0.25);
        color: var(--brand-secondary);
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.96), rgba(255, 246, 230, 0.88));
      }

      .step-actions__button--prev:hover,
      .step-actions__button--prev:focus-visible {
        border-color: rgba(0, 163, 255, 0.55);
        color: var(--brand-primary);
      }

      .step-actions__button i {
        font-size: 1.25rem;
      }

      @media (max-width: 575.98px) {
        .step-actions {
          padding: 0.75rem 0.875rem;
        }

        .step-actions__button {
          width: 100%;
          margin-left: 0;
        }
      }

      .card-section {
        border: 1px solid var(--border-color);
        border-radius: 1rem;
        background: var(--surface-strong);
        box-shadow: 0 12px 30px rgba(24, 64, 120, 0.08);
      }

      .form-step {
        display: none;
      }

      .form-step.is-active {
        display: block;
      }

      .form-section {
        scroll-margin-top: 7rem;
      }

      .form-section + .form-section {
        margin-top: 1.5rem;
      }

      .section-divider {
        margin: 2rem 0 1.5rem;
        border: 0;
        border-top: 1px dashed var(--border-color);
      }

      .form-subsection {
        margin-top: 1.5rem;
      }

      .subsection-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      @media (max-width: 768px) {
        header.site-header {
          padding: 0;
        }

        .badge-open {
          width: 100%;
          justify-content: center;
        }

        .section-title {
          justify-content: flex-start;
        }

        .section-nav {
          padding: 0;
        }

        .section-nav__inner {
          padding: 1rem 0;
        }

        .section-nav__top {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.5rem;
        }

        .section-nav__registration {
          width: 100%;
        }

        .section-nav__list {
          --step-size: 2.5rem;
          flex-wrap: wrap;
          gap: 1rem;
          padding: 0;
        }

        .section-nav__list::before,
        .section-nav__list::after {
          display: none;
        }

        .section-nav__item {
          flex: 1 0 45%;
        }

        .section-nav__label {
          max-width: none;
          font-size: 0.9rem;
        }
      }

      @media (max-width: 767.98px) {
        header.site-header {
          height: 184px;
          min-height: 184px;
        }
      }

      .section-header {
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 0.75rem;
        margin-bottom: 1.25rem;
      }

      .required::after {
        content: "*";
        color: #d32f2f;
        margin-left: 0.25rem;
      }

      .form-text {
        color: var(--text-muted);
      }

      .file-input-wrapper {
        border: 1px dashed var(--border-color);
        border-radius: 0.75rem;
        padding: 1rem;
        background: rgba(0, 83, 164, 0.03);
      }

      .file-input-wrapper label {
        font-weight: 600;
      }

      .file-name {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-top: 0.25rem;
      }

      .toast-container {
        z-index: 1080;
      }

      .legend-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        font-size: 0.85rem;
        color: var(--brand-secondary);
        background: rgba(0, 83, 164, 0.12);
        padding: 0.35rem 0.75rem;
        border-radius: 999px;
      }

      .tooltip-inner {
        text-align: left;
      }

      .btn-outline-primary:focus-visible,
      .form-control:focus,
      .form-select:focus,
      .form-check-input:focus {
        box-shadow: 0 0 0 0.25rem rgba(0, 83, 164, 0.25);
        border-color: var(--brand-highlight);
      }

      .border-dashed {
        border-style: dashed !important;
      }
    </style>
    <style>
      :root {
        --color-background: #be99df;
        --color-card-bg: #ffffff;
        --color-card-border: #dbdfe7;
        --color-card-shadow: rgba(99, 77, 255, 0.06);
        --color-header: #525356;
        --color-label: #5c3875;
        --color-input-text: #71747a;
        --color-input-border: #dbdfe7;
        --color-focus-border: rgb(90, 76, 194);
        --color-submit-btn-bg: #5c3875;
        --color-submit-btn-text: #ffffff;
      }

      body {
        background: var(--color-background);
        font-family: "Public Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        font-size: 14px;
        color: var(--color-input-text);
      }

      .card {
        background: var(--color-card-bg);
        border: 1px solid var(--color-card-border);
        border-radius: 8px;
        box-shadow: 0 4px 16px var(--color-card-shadow);
        padding: 24px;
        margin-bottom: 16px;
      }

      label {
        color: var(--color-label);
        font-weight: 600;
      }

      h1,
      h2,
      .section-title {
        color: var(--color-header);
      }

      .section-title {
        font-size: 20px;
        margin-top: 24px;
        text-align: center;
      }

      .form-control,
      .form-select {
        border: 1px solid var(--color-input-border);
        border-radius: 6px;
        padding: 12px;
        font-size: 14px;
        color: var(--color-input-text);
      }

      .form-control:focus,
      .form-select:focus {
        border-color: var(--color-focus-border);
        box-shadow: none;
      }

      .btn-submit {
        background: var(--color-submit-btn-bg);
        color: var(--color-submit-btn-text);
        height: 48px;
        border-radius: 6px;
        font-weight: 600;
      }

      .form-check-label {
        white-space: nowrap;
      }

      .settings-panel {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 1000;
      }

      .settings-panel label {
        font-size: 13px;
        margin-bottom: 2px;
        color: #525356;
      }

      .settings-panel input[type="color"] {
        width: 60px;
        height: 30px;
        border: 1px solid #ddd;
        cursor: pointer;
        padding: 0;
      }

      .settings-panel select {
        width: 150px;
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 13px;
      }

      #iframeTipoInscricao {
        width: 100%;
        min-height: 200px;
        border: none;
        transition: height 0.3s;
      }
    </style>
  </head>

<body>
  <div class="settings-panel">
    <div>
      <label for="bgColorPicker">Fundo:</label>
      <input type="color" id="bgColorPicker" value="#BE99DF" />
    </div>
    <div>
      <label for="labelColorPicker">R√≥tulos/Bot√£o:</label>
      <input type="color" id="labelColorPicker" value="#5C3875" />
    </div>
    <div>
      <label for="textColorPicker">Textos Gerais:</label>
      <input type="color" id="textColorPicker" value="#525356" />
    </div>
    <div>
      <label for="fontFamilySelector">Fonte:</label>
      <select id="fontFamilySelector">
        <option value="'Open Sans', sans-serif">Open Sans (Padr√£o)</option>
        <option value="'Roboto', sans-serif">Roboto</option>
        <option value="'Montserrat', sans-serif">Montserrat</option>
        <option value="'Lato', sans-serif">Lato</option>
        <option value="'BR Omny', sans-serif">BR Omny (oficial da PCR)</option>
      </select>
    </div>
  </div>

  <div class="container mt-4">
      <div class="text-center">
          <img src="https://statics.recife.pe.gov.br/images/dynamics/semul/recife-das-mulheres.png?w=400"
               alt="Recife das Mulheres" class="img-fluid" style="max-width:400px;">
      </div>
      <div class="card mt-4">
          <h1 class="text-center">SECRETARIA DA MULHER DO RECIFE</h1>
          <h2 class="text-center">Formul√°rio de Inscri√ß√£o</h2>
          <form id="formInscricao">
              <div class="mb-3">
                  <label for="tipodeinscricao" class="form-label">Tipo de Inscri√ß√£o</label>
                  <select id="tipodeinscricao" name="tipodeinscricao" class="form-select" required>
                      <option value="">Selecione</option>
                      <option value="Centro Marta Almeida">Cursos Profissionalizantes - Centro Marta Almeida</option>
                      <option value="Rede de Artes√£s">Rede de Artes√£s</option>
                      <option value="T√° com Elas">T√° com Elas</option>
                  </select>
              </div>
              <h2 class="section-title">1 - Dados Pessoais</h2>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="cpf" class="form-label">CPF</label>
                      <input type="text" id="cpf" name="cpf" class="form-control" placeholder="___.___.___-__" maxlength="14" value="{{ $json.preferred_username }}">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="datanasc" class="form-label">Data de nascimento</label>
                      <input type="text" id="datanasc" name="datanasc" class="form-control" placeholder="dd/mm/aaaa" value="{{ $json.result.datanasc }}">
                  </div>
              </div>
              <div class="mb-3">
                  <label for="nome" class="form-label">Nome completo (conforme RG)</label>
                  <input type="text" id="nome" name="nome" class="form-control" value="{{ $json.dob }}">
              </div>
              <div class="mb-3">
                  <label for="rg" class="form-label">RG</label>
                  <input type="text" id="rg" name="rg" class="form-control">
              </div>
              <div class="mb-3">
                  <label for="nomesocial" class="form-label">Nome social</label>
                  <input type="text" id="nomesocial" name="nomesocial" class="form-control">
              </div>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="telefone" class="form-label">Telefone</label>
                      <input type="text" id="telefone" name="telefone" class="form-control" placeholder="(##) #####-####" value="{{ $json.telefone }}">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label class="form-label">√â WhatsApp?</label>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="whatsapp" value="Sim"><label class="form-check-label">Sim</label>
                      </div>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="whatsapp" value="N√£o"><label class="form-check-label">N√£o</label>
                      </div>
                  </div>
              </div>
              <div class="mb-3">
                  <label for="telefone2" class="form-label">Telefone 2</label>
                  <input type="text" id="telefone2" name="telefone2" class="form-control" placeholder="(##) #####-####">
              </div>
              <div class="mb-3">
                  <label for="email" class="form-label">E-mail</label>
                  <input type="email" id="email" name="email" class="form-control" placeholder="exemplo@dominio.com" value="{{ $json.email }}">
              </div>
              <div class="mb-3">
                  <label for="etnia" class="form-label">Etnia</label>
                  <select id="etnia" name="etnia" class="form-select">
                      <option value="">Selecione</option>
                      <option value="Preta">Preta</option>
                      <option value="Parda">Parda</option>
                      <option value="Branca">Branca</option>
                      <option value="Ind√≠gena">Ind√≠gena</option>
                      <option value="Amarela">Amarela</option>
                      <option value="Outra">Outra</option>
                  </select>
              </div>
              <div class="mb-3">
                  <label for="genero" class="form-label">Identidade de g√™nero</label>
                  <select id="genero" name="genero" class="form-select">
                      <option value="">Selecione</option>
                      <option value="Mulher Cis">Mulher Cis</option>
                      <option value="Mulher Trans">Mulher Trans</option>
                      <option value="N√£o bin√°rio">N√£o bin√°rio</option>
                      <option value="Prefiro n√£o responder">Prefiro n√£o responder</option>
                  </select>
              </div>
              <div class="mb-3">
                  <label class="form-label">Voc√™ se identifica como pessoa com defici√™ncia?</label>
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="pcd" id="pcdSim" value="Sim" required><label class="form-check-label" for="pcdSim">Sim</label>
                  </div>
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="pcd" id="pcdNao" value="N√£o"><label class="form-check-label" for="pcdNao">N√£o</label>
                  </div>
              </div>
              <div class="mb-3" id="divCategoriaPCD" style="display:none;">
                  <label for="categoriasepcd" class="form-label">Categoria (se PCD)</label>
                  <select id="categoriasepcd" name="categoriasepcd" class="form-select">
                      <option value="">Selecione a categoria</option>
                      <option value="Defici√™ncia F√≠sica">Defici√™ncia F√≠sica</option>
                      <option value="Defici√™ncia Auditiva">Defici√™ncia Auditiva</option>
                      <option value="Defici√™ncia Visual">Defici√™ncia Visual</option>
                      <option value="Defici√™ncia Intelectual">Defici√™ncia Intelectual</option>
                      <option value="Defici√™ncia Psicossocial">Defici√™ncia Psicossocial</option>
                      <option value="Defici√™ncias M√∫ltiplas">Defici√™ncias M√∫ltiplas</option>
                  </select>
              </div>
              <div class="mb-3" id="divDeficienciaPCD" style="display:none;">
                  <label for="deficiencia" class="form-label">Defici√™ncia</label>
                  <select id="deficiencia" name="deficiencia" class="form-select">
                      <option value="">Selecione (caso tenha defici√™ncia)</option>
                  </select>
              </div>
              <div class="mb-3">
                  <label class="form-label">Recebe algum benef√≠cio do governo?</label>
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="recebebeneficio" value="Sim" id="beneficioSim" required>
                      <label class="form-check-label" for="beneficioSim">Sim</label>
                  </div>
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="recebebeneficio" value="N√£o" id="beneficioNao">
                      <label class="form-check-label" for="beneficioNao">N√£o</label>
                  </div>
              </div>
              <div class="mb-3" id="divBeneficios" style="display:none;">
                  <label class="form-label fw-bold">Se sim, quais?</label>
                  <div class="row">
                      <div class="col-md-6">
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Aux√≠lio-acolhida"><label class="form-check-label">Aux√≠lio-acolhida</label></div>
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Bolsa Fam√≠lia"><label class="form-check-label">Bolsa Fam√≠lia</label></div>
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Aux√≠lio Emergencial"><label class="form-check-label">Aux√≠lio Emergencial</label></div>
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Benef√≠cio de Presta√ß√£o Continuada (BPC)"><label class="form-check-label">Benef√≠cio de Presta√ß√£o Continuada (BPC)</label></div>
                      </div>
                      <div class="col-md-6">
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Programa de Erradica√ß√£o do Trabalho Infantil (PETI)"><label class="form-check-label">Programa de Erradica√ß√£o do Trabalho Infantil (PETI)</label></div>
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Garantia-Safra e Seguro-Defeso (ou Pescador Artesanal)"><label class="form-check-label">Garantia-Safra e Seguro-Defeso...</label></div>
                          <div class="form-check"><input class="form-check-input" type="checkbox" name="beneficios[]" value="Aux√≠lio-Reclus√£o"><label class="form-check-label">Aux√≠lio-Reclus√£o</label></div>
                      </div>
                  </div>
              </div>
              <div class="mb-3">
                  <label for="escolaridade" class="form-label">Escolaridade</label>
                  <select id="escolaridade" name="escolaridade" class="form-select">
                      <option value="">Selecione</option>
                      <option value="Ensino fundamental incompleto">Ensino fundamental incompleto</option>
                      <option value="Ensino fundamental completo">Ensino fundamental completo</option>
                      <option value="Ensino m√©dio incompleto">Ensino m√©dio incompleto</option>
                      <option value="Ensino m√©dio completo">Ensino m√©dio completo</option>
                      <option value="Ensino superior incompleto">Ensino superior incompleto</option>
                      <option value="Ensino superior completo">Ensino superior completo</option>
                      <option value="P√≥s-gradua√ß√£o">P√≥s-gradua√ß√£o</option>
                  </select>
              </div>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="quantosfilhos" class="form-label">Quantos filhos</label>
                      <input type="number" id="quantosfilhos" name="quantosfilhos" class="form-control" min="0">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="habitantes" class="form-label">N√∫mero de habitantes na resid√™ncia</label>
                      <input type="number" id="habitantes" name="habitantes" class="form-control" min="0">
                  </div>
              </div>
              <div class="mb-3">
                  <label for="rendamensal" class="form-label">Qual renda domiciliar total?</label>
                  <select id="rendamensal" name="rendamensal" class="form-select">
                      <option value="">Selecione</option>
                      <option value="At√© 1 sal√°rio m√≠nimo">At√© 1 sal√°rio m√≠nimo</option>
                      <option value="At√© 2 sal√°rios m√≠nimos">At√© 2 sal√°rios m√≠nimos</option>
                      <option value="At√© 5 sal√°rios m√≠nimos">At√© 5 sal√°rios m√≠nimos</option>
                      <option value="At√© 10 sal√°rios m√≠nimos">At√© 10 sal√°rios m√≠nimos</option>
                      <option value="Mais de 10 sal√°rios m√≠nimos">Mais de 10 sal√°rios m√≠nimos</option>
                  </select>
              </div>
              <div class="mb-3">
                  <label for="rendaquecontribu" class="form-label">Renda que contribui</label>
                  <select id="rendaquecontribu" name="rendaquecontribu" class="form-select">
                      <option value="">Selecione</option>
                      <option value="At√© 1 sal√°rio m√≠nimo">At√© 1 sal√°rio m√≠nimo</option>
                      <option value="At√© 2 sal√°rios m√≠nimos">At√© 2 sal√°rios m√≠nimos</option>
                      <option value="At√© 5 sal√°rios m√≠nimos">At√© 5 sal√°rios m√≠nimos</option>
                      <option value="At√© 10 sal√°rios m√≠nimos">At√© 10 sal√°rios m√≠nimos</option>
                      <option value="Mais de 10 sal√°rios m√≠nimos">Mais de 10 sal√°rios m√≠nimos</option>
                  </select>
              </div>
              <h2 class="section-title">2 - Dados da Resid√™ncia</h2>
              <div class="row">
                  <div class="col-md-6 mb-3"><label for="cep" class="form-label">CEP</label><input type="text" id="cep" name="cep" class="form-control" placeholder="#####-###" value="{{ $json.postal_code }}"></div>
                  <div class="col-md-6 mb-3"><label for="logradouro" class="form-label">Logradouro</label><input type="text" id="logradouro" name="logradouro" class="form-control" value="{{ $json.addressStreet }}"></div>
              </div>
              <div class="row">
                  <div class="col-md-6 mb-3"><label for="numero" class="form-label">N√∫mero</label><input type="text" id="numero" name="numero" class="form-control" value="{{ $json.addressNumber }}"></div>
                  <div class="col-md-6 mb-3"><label for="complemento" class="form-label">Complemento</label><input type="text" id="complemento" name="complemento" class="form-control" value="{{ $json.addressComplement }}"></div>
              </div>
              <div class="mb-3"><label for="bairro" class="form-label">Bairro</label><input type="text" id="bairro" name="bairro" class="form-control" value="{{ $json.neighborhood }}"></div>
              <div class="mb-3"><label for="comprovres" class="form-label">Comprovante de resid√™ncia</label><input type="file" id="comprovres" name="comprovres" class="form-control" accept=".pdf,.jpg,.jpeg,.png,.heic"></div>
              <div id="divEndNegocio" style="display: none;">
                  <div class="mb-3 form-check">
                      <input type="checkbox" id="endnegocio" name="endnegocio" class="form-check-input">
                      <label for="endnegocio" class="form-check-label">Endere√ßo √© do neg√≥cio</label>
                  </div>
              </div>
              <div class="mb-3" id="divLocalMentoria" style="display: none;">
                  <label class="form-label">Local da mentoria</label>
                  <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="localmentoria" value="Sim"><label class="form-check-label">Sim</label></div>
                  <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="localmentoria" value="N√£o"><label class="form-check-label">N√£o</label></div>
              </div>
              
              <iframe id="iframeTipoInscricao" style="width:100%;min-height:200px;border:none;transition: height 0.3s;" title="Se√ß√£o espec√≠fica"></iframe>

              
              <h2 class="section-title">Cursos</h2>
              <div class="row">
                <div class="mb-3">
                  <label for="areatematica" class="form-label">√Årea Tem√°tica</label>
                  <select id="areatematica" name="areatematica" class="form-select">
                      <option value="">Selecione</option>
                      <option value="audio">√Åudio/Visual e Fotografia</option>
                      <option value="moda">Moda e costura</option>
                      <option value="gastronomia">Gastronomia</option>
                      <option value="outros">Outros</option>
                  </select>
                </div>
              <button type="submit" class="btn btn-submit w-100">Enviar</button>
          </form>
          <div id="responseMessage" class="mt-3"></div>
      </div>
  </div>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
<script>
window.onload = function() {
    const root = document.documentElement; const bgColorPicker = document.getElementById('bgColorPicker'); const labelColorPicker = document.getElementById('labelColorPicker'); const textColorPicker = document.getElementById('textColorPicker'); const fontFamilySelector = document.getElementById('fontFamilySelector'); const brOmnyRegularBase64 = '{{ $json.BROmnyRegular || "" }}'; const brOmnyBoldBase64 = '{{ $json.BROmnyBold || "" }}'; const safeLocalStorage = { getItem: (key) => { try { return localStorage.getItem(key); } catch { return null; } }, setItem: (key, value) => { try { localStorage.setItem(key, value); } catch {} } };

    function injectBrOmny() { if (document.getElementById('br-omny-style') || !brOmnyRegularBase64) return; const st = document.createElement('style'); st.id = 'br-omny-style'; st.textContent = `@font-face { font-family: 'BR Omny'; src: url('data:font/woff2;base64,${brOmnyRegularBase64}') format('woff2'); font-weight: normal; font-style: normal; font-display: swap; }@font-face { font-family: 'BR Omny'; src: url('data:font/woff2;base64,${brOmnyBoldBase64}') format('woff2'); font-weight: 600; font-style: normal; font-display: swap; }`; document.head.appendChild(st); }
    const applySettings = () => { const bg = safeLocalStorage.getItem('bgColor') || '#BE99DF'; const lbl = safeLocalStorage.getItem('labelColor') || '#5C3875'; const txt = safeLocalStorage.getItem('textColor') || '#525356'; const ff = safeLocalStorage.getItem('fontFamily') || "'Open Sans', sans-serif"; root.style.setProperty('--color-background', bg); root.style.setProperty('--color-label', lbl); root.style.setProperty('--color-submit-btn-bg', lbl); root.style.setProperty('--color-input-text', txt); root.style.setProperty('--color-header', txt); root.style.setProperty('--font-family', ff); bgColorPicker.value = bg; labelColorPicker.value = lbl; textColorPicker.value = txt; fontFamilySelector.value = ff; if (ff.includes('BR Omny')) injectBrOmny(); };
    
    bgColorPicker.addEventListener('input', e => { root.style.setProperty('--color-background', e.target.value); safeLocalStorage.setItem('bgColor', e.target.value); });
    labelColorPicker.addEventListener('input', e => { root.style.setProperty('--color-label', e.target.value); root.style.setProperty('--color-submit-btn-bg', e.target.value); safeLocalStorage.setItem('labelColor', e.target.value); });
    textColorPicker.addEventListener('input', e => { root.style.setProperty('--color-input-text', e.target.value); root.style.setProperty('--color-header', e.target.value); safeLocalStorage.setItem('textColor', e.target.value); });
    fontFamilySelector.addEventListener('change', e => { const ff = e.target.value; root.style.setProperty('--font-family', ff); safeLocalStorage.setItem('fontFamily', ff); if (ff.includes('BR Omny')) injectBrOmny(); });
    
    applySettings();

    const cpf = document.getElementById('cpf'), datanasc = document.getElementById('datanasc'), tel = document.getElementById('telefone'), tel2 = document.getElementById('telefone2'), cep = document.getElementById('cep'), logra = document.getElementById('logradouro'), bairro = document.getElementById('bairro'), catSel = document.getElementById('categoriasepcd'), defSel = document.getElementById('deficiencia'), pcdSim = document.getElementById('pcdSim'), pcdNao = document.getElementById('pcdNao'), divCat = document.getElementById('divCategoriaPCD'), divDef = document.getElementById('divDeficienciaPCD'), renda = document.getElementById('rendamensal'), contrib = document.getElementById('rendaquecontribu'), tipoSel = document.getElementById('tipodeinscricao'), iframe = document.getElementById('iframeTipoInscricao'), form = document.getElementById('formInscricao'), resp = document.getElementById('responseMessage'), fileComp = document.getElementById('comprovres'), beneficioSim = document.getElementById('beneficioSim'), beneficioNao = document.getElementById('beneficioNao'), divBeneficios = document.getElementById('divBeneficios'), divMentoria = document.getElementById('divLocalMentoria'), divEndNegocio = document.getElementById('divEndNegocio'), endNegocioCheck = document.getElementById('endnegocio');

    const aplicarMascaraCPF = v => { let d = v.replace(/\D/g, '').slice(0, 11); return d.replace(/(\d{3})(\d{3})(\d{3})(\d{2})?/, '$1.$2.$3-$4').replace(/[-.]$/, '') };
    const aplicarMascaraData = v => v.replace(/\D/g, '').slice(0, 8).replace(/(\d{2})(\d{2})(\d{4})?/, '$1/$2/$3').replace(/\/$/, '');
    const aplicarMascaraTelefone = v => { let d = v.replace(/\D/g, '').slice(0, 11); return d.replace(/(\d{2})(\d{5})(\d{4})?/, '($1) $2-$3').replace(/[- ]$/, '') };
    const aplicarMascaraCEP = v => v.replace(/\D/g, '').slice(0, 8).replace(/(\d{5})(\d{3})?/, '$1-$2').replace(/-$/, '');
    const blobToBase64 = b => new Promise(r => { const f = new FileReader(); f.onloadend = () => r(f.result.split(',')[1]); f.readAsDataURL(b) });
    const defPorCat = {"Defici√™ncia F√≠sica":["Paraplegia (comprometimento total das pernas)","Tetraplegia (comprometimento de bra√ßos e pernas)","Hemiplegia (paralisia de um lado do corpo)","Amputa√ß√µes ou aus√™ncia cong√™nita de membros","Paralisia cerebral","M√°-forma√ß√£o cong√™nita ou adquirida (por traumas, acidentes ou doen√ßas)","Nanismo (estatura muito abaixo da m√©dia, podendo acarretar limita√ß√µes motoras)","Mielomeningocele (espinha b√≠fida)","Sequelas de poliomielite","Distrofia muscular de Duchenne","Esclerose m√∫ltipla"],"Defici√™ncia Auditiva":["Perda auditiva leve","Surdez moderada, severa ou profunda","Surdez neurossensorial","Surdez condutiva","Surdez mista","Surdez pr√©-lingual","Surdez p√≥s-lingual"],"Defici√™ncia Visual":["Baixa vis√£o","Cegueira","Retinopatia diab√©tica","Glaucoma avan√ßado","Degenera√ß√£o macular","Catarata cong√™nita","Retinose pigmentar","Neuropatia √≥ptica","Albinismo ocular"],"Defici√™ncia Intelectual":["S√≠ndrome de Down","Transtorno do Espectro do Autismo (TEA) com comprometimento cognitivo","S√≠ndrome do X Fr√°gil","Atraso global do desenvolvimento","Microcefalia","S√≠ndrome de Williams","Fenilceton√∫ria n√£o tratada","Hidrocefalia cong√™nita"],"Defici√™ncia Psicossocial":["Esquizofrenia","Transtorno de Estresse P√≥s-Traum√°tico (TEPT)","Depress√£o cr√¥nica resistente","Transtorno bipolar grave","Transtorno de Ansiedade Generalizada incapacitante","Transtornos graves de personalidade","Transtorno Obsessivo-Compulsivo severo"],"Defici√™ncias M√∫ltiplas":["S√≠ndrome de Usher","Cegueira + TEA","Surdez + Defici√™ncia Intelectual + Paralisia Cerebral","Cegueira + S√≠ndrome de Down","Surdocegueira","S√≠ndrome de Charge","Surdez + Transtorno Bipolar","Paralisia cerebral + Defici√™ncia Intelectual","Amputa√ß√µes + Surdez","Nanismo + Defici√™ncia Visual"]};
    
    function popularDef(catSel, defSel) { defSel.innerHTML = '<option value="">Selecione (caso tenha defici√™ncia)</option>'; (defPorCat[catSel.value] || []).forEach(txt => { const opt = document.createElement('option'); opt.value = txt; opt.textContent = txt; defSel.appendChild(opt); }); }
    function filtrarRenda(rendaSel, contribSel) { const val = rendaSel.value; const opts = [...contribSel.options]; const idx = opts.findIndex(o => o.value === val); opts.forEach((o, i) => o.style.display = idx === -1 || i === 0 || i <= idx ? '' : 'none'); }
    function togglePCD(radioSim, divCat, divDef, catSel, defSel) { if (radioSim.checked) { divCat.style.display = 'block'; divDef.style.display = 'block'; } else { divCat.style.display = 'none'; divDef.style.display = 'none'; catSel.value = ''; defSel.innerHTML = '<option value="">Selecione (caso tenha defici√™ncia)</option>'; } }
    function toggleBeneficios(radioSim, divBeneficios) { if (radioSim.checked) { divBeneficios.style.display = 'block'; } else { divBeneficios.style.display = 'none'; divBeneficios.querySelectorAll('input[type="checkbox"]').forEach(chk => chk.checked = false); } }
    async function buscarCEP(cepIn, logra, bairro) { const raw = cepIn.value.replace(/\D/g, ''); if (raw.length !== 8) return; try { const d = await fetch(`https://viacep.com.br/ws/${raw}/json/`).then(r => r.json()); if (!d.erro) { logra.value = d.logradouro || ''; bairro.value = d.bairro || ''; } else alert('CEP n√£o encontrado'); } catch {} }
    function resetIframe(iframeEl, divMentoriaEl, divEndNegocioEl, endNegocioCheckbox) {
      iframeEl.style.display = 'none';
      iframeEl.style.height = '0px';
      iframeEl.src = '';
      iframeEl.removeAttribute('data-loaded-type');
      if (divMentoriaEl) {
        divMentoriaEl.style.display = 'none';
        divMentoriaEl.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
      }
      if (divEndNegocioEl) {
        divEndNegocioEl.style.display = 'none';
        if (endNegocioCheckbox) endNegocioCheckbox.checked = false;
      }
    }

    async function atualizarIframe(sel, iframe, divMentoria, divEndNegocio, endNegocioCheck) {
      const tipo = (sel?.value || '').trim();
      resp.textContent = '';
      if (!tipo) { resetIframe(iframe, divMentoria, divEndNegocio, endNegocioCheck); return; }
      iframe.dataset.loadingType = tipo;
      try {
        const responseArray = await fetch('https://webhook-n8n-dev-conectarecife.recife.pe.gov.br/webhook/carregar-iframe', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ tipodeinscricao: tipo })
        }).then(r => r.json());
        const responseData = Array.isArray(responseArray) ? responseArray[0] : {};
        const html = responseData?.html;
        if (!html) { resetIframe(iframe, divMentoria, divEndNegocio, endNegocioCheck); return; }

        iframe.style.display = 'block';
        iframe.src = 'data:text/html;charset=utf-8,' + encodeURIComponent(html);
        iframe.dataset.loadedType = tipo;

        divMentoria.style.display = 'block';
        divEndNegocio.style.display = 'block';

        if (responseData.height) { iframe.style.height = responseData.height + 'px'; }
      } catch (e) {
        console.error('Falha ao processar resposta do iframe:', e);
        resetIframe(iframe, divMentoria, divEndNegocio, endNegocioCheck);
      }
    }

    async function iniciarEnvio(form, resp, fileInput, iframe) { resp.textContent = 'Coletando dados...'; let base64 = ''; if (fileInput.files.length) { const f = fileInput.files[0]; if (f.size > 25 * 1024 * 1024) { alert('O arquivo excede o limite de 25MB.'); resp.textContent = ''; return; } base64 = await blobToBase64(f); } const fd = new FormData(form); const dadosPai = {}; fd.forEach((value, key) => { if (key.endsWith('[]')) { const cleanKey = key.slice(0, -2); if (!dadosPai[cleanKey]) dadosPai[cleanKey] = []; dadosPai[cleanKey].push(value); } else { dadosPai[key] = value; } }); dadosPai.comprovres_base64 = base64; delete dadosPai.comprovres; const iframeAtivo = iframe && iframe.contentWindow && iframe.style.display !== 'none' && iframe.dataset.loadedType; if (iframeAtivo) { resp.textContent = 'Enviando...'; iframe.contentWindow.postMessage({ tipo: 'enviarDados', dadosPai: dadosPai }, '*'); } else { try { const r = await fetch('https://webhook-n8n-dev-conectarecife.recife.pe.gov.br/webhook/receber-inscricao', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(dadosPai) }).then(r => r.text()); resp.textContent = r; form.reset(); } catch(e) { resp.textContent = 'Erro ao enviar inscri√ß√£o: ' + e.message; } } }

    window.addEventListener('message', (event) => {
      if (!event.data || event.source !== iframe.contentWindow) return;
      if (event.data.tipo === 'ajusteAltura') {
        iframe.style.height = event.data.altura + 'px';
      } else if (event.data.tipo === 'envioConcluido') {
        resp.textContent = event.data.mensagem;
        if (event.data.status === 'sucesso') {
          form.reset();
          resetIframe(iframe, divMentoria, divEndNegocio, endNegocioCheck);
        }
      }
    });

    cpf.addEventListener('input', e => e.target.value = aplicarMascaraCPF(e.target.value));
    datanasc.addEventListener('input', e => e.target.value = aplicarMascaraData(e.target.value));
    tel.addEventListener('input', e => e.target.value = aplicarMascaraTelefone(e.target.value));
    tel2.addEventListener('input', e => e.target.value = aplicarMascaraTelefone(e.target.value));
    cep.addEventListener('input', e => e.target.value = aplicarMascaraCEP(e.target.value));
    cep.addEventListener('blur', () => buscarCEP(cep, logra, bairro));
    catSel.addEventListener('change', () => popularDef(catSel, defSel));
    renda.addEventListener('change', () => filtrarRenda(renda, contrib));
    pcdSim.addEventListener('change', () => togglePCD(pcdSim, divCat, divDef, catSel, defSel));
    pcdNao.addEventListener('change', () => togglePCD(pcdSim, divCat, divDef, catSel, defSel));
    beneficioSim.addEventListener('change', () => toggleBeneficios(beneficioSim, divBeneficios));
    beneficioNao.addEventListener('change', () => toggleBeneficios(beneficioSim, divBeneficios));
    tipoSel.addEventListener('change', () => atualizarIframe(tipoSel, iframe, divMentoria, divEndNegocio, endNegocioCheck));
    form.addEventListener('submit', e => { e.preventDefault(); iniciarEnvio(form, resp, fileComp, iframe); });

    togglePCD(pcdSim, divCat, divDef, catSel, defSel);
    toggleBeneficios(beneficioSim, divBeneficios);
    filtrarRenda(renda, contrib);
    atualizarIframe(tipoSel, iframe, divMentoria, divEndNegocio, endNegocioCheck);
};
</script>
</body>
</html>
